window.addEventListener('DOMContentLoaded', () => {

    //preloader
    window.onload = function () {
        let preloader = document.querySelector('.preloader');
        preloader.style.display = 'none';
    };


    //мобильное меню 
    const mobileMenu = document.querySelector('.header__mobile-menu');

    mobileMenu.addEventListener('click', (e) => {
        document.querySelector('.header__mobile-menu-icon').classList.toggle('open-mobile-menu');

        document.querySelector('.header__navigation').classList.toggle('header__navigation--active');
    });


    //слайдер номера
    let offset = 0;
    let slideIndex = 1;

    const slides = document.querySelectorAll('.rooms__slide'), //сами слайды
        prev = document.querySelector('.rooms__prev'), // стрелка назад
        next = document.querySelector('.rooms__next'), //стрелка вперед
        slidesWrapper = document.querySelector('.rooms__slider-wrapper'), //обертка всех слайдов
        width = window.getComputedStyle(slidesWrapper).width, //получаем ширину контейнера со слайдом видимая область
        slidesField = document.querySelector('.rooms__slider-inner'); //контейнер внутригий со всеми слайдами не видимый



    slidesField.style.width = 100 * slides.length + '%';
    slidesField.style.display = 'flex';
    slidesField.style.transition = '0.5s all';

    slidesWrapper.style.overflow = 'hidden';

    slides.forEach(slide => {
        slide.style.width = width;
    });

    next.addEventListener('click', () => {
        if (offset == (+width.slice(0, width.length - 2) * (slides.length - 1))) {
            offset = 0;
        } else {
            offset += +width.slice(0, width.length - 2);
        }

        slidesField.style.transform = `translateX(-${offset}px)`;

        if (slideIndex == slides.length) {
            slideIndex = 1;
        } else {
            slideIndex++;
        }


    });

    prev.addEventListener('click', () => {
        if (offset == 0) {
            offset = +width.slice(0, width.length - 2) * (slides.length - 1);
        } else {
            offset -= +width.slice(0, width.length - 2);
        }

        slidesField.style.transform = `translateX(-${offset}px)`;

        if (slideIndex == 1) {
            slideIndex = slides.length;
        } else {
            slideIndex--;
        }


    });

    //слайдер отзывы

    let reviewsSlideIndex = 1;
    const reviewsBox = document.querySelector('.reviews__box'),
        reviewsItems = document.querySelectorAll('.reviews__item');

    showReviews();

    function showReviews() {

        reviewsItems.forEach((item) => item.style.display = 'none');

        reviewsItems[reviewsSlideIndex - 1].style.display = 'flex';
    }

    reviewsBox.style.position = 'relative';

    const indicators = document.createElement('ol'),
        dots = [];
    indicators.classList.add('carousel-indicators');
    indicators.style.cssText = `
        position: absolute;
        right: 0;
        bottom: -55px;
        left: 0;
        z-index: 15;
        display: flex;
        justify-content: center;
        margin-right: 15%;
        margin-left: 15%;
        list-style: none;
    `;
    reviewsBox.append(indicators);

    for (let i = 0; i < reviewsItems.length; i++) {
        const dot = document.createElement('li');
        dot.setAttribute('data-slide-to', i + 1);
        dot.style.cssText = `
        box-sizing: content-box;
        flex: 0 1 auto;
        width: 22px;
        height: 22px;
        margin-right: 15px;
        margin-left: 15px;
        cursor: pointer;
        background: #fff;
        border: 5px solid #2C3E50;
        background-clip: padding-box;
        border-radius: 50%;
    `;
        if (i == 0) {
            dot.style.background = "#2C3E50";
        }
        indicators.append(dot);
        dots.push(dot);
    };

    dots.forEach(dot => {
        dot.addEventListener('click', (e) => {
            const slideTo = e.target.getAttribute('data-slide-to');

            reviewsSlideIndex = slideTo;

            dots.forEach(dot => dot.style.background = "#fff");
            dots[reviewsSlideIndex - 1].style.background = '#2C3E50';

            showReviews(reviewsSlideIndex);
        });
    });


    //calc

    const nightPlusBtn = document.querySelector('.reserve__nights-plus'), //кнопка плюса для ночей
        nightMinusBtn = document.querySelector('.reserve__nights-minus'), //кнопка минуса для ночей
        nightNumber = document.querySelector('.reserve__nights-number'), //число ночей
        roomsPlusBtn = document.querySelector('.reserve__quantity-plus'), //номера плюс
        roomsMinusBtn = document.querySelector('.reserve__quantity-minus'), //номера минус
        roomsNumber = document.querySelector(".reserve__quantity-number"); //количество номеров

    let defNumberForNight = 1, //начало отсчета число ночей
        defNumberForRooms = 1, //начало отсчета количество номеров
        defNumberMax = 15; //максимальное количество выбора номеров

    nightNumber.textContent = `${defNumberForNight}`;

    roomsNumber.textContent = `${defNumberForRooms}`;

    showQuantityPlus(roomsPlusBtn, roomsNumber);
    showQuantityMinus(roomsMinusBtn, roomsNumber);

    showNumberPlus(nightPlusBtn, nightNumber);
    showNumberMinus(nightMinusBtn, nightNumber);

    //функция увеличения числа
    function showNumberPlus(objectClickPlus, objectChangePlus) {
        objectClickPlus.addEventListener('click', (e) => {
            objectChangePlus.textContent = `${++defNumberForNight}`;
        });
    }

    //функция уменьшения числа
    function showNumberMinus(objectClickMinus, objectChangeMinus) {
        objectClickMinus.addEventListener('click', (e) => {

            if (defNumberForNight > 1) {
                objectChangeMinus.textContent = `${--defNumberForNight}`;
            } else if (defNumberForNight < 2) {
                objectChangeMinus.textContent = `1`;
            }
        });
    }

    //выбор из ограниченного количества --> +
    function showQuantityPlus(eventPlusOn, changePlusIn) {
        eventPlusOn.addEventListener('click', (e) => {

            changePlusIn.textContent = `${++defNumberForRooms}`;

            if (defNumberForRooms > defNumberMax) {
                defNumberForRooms = defNumberMax;

                changePlusIn.textContent = `${defNumberForRooms}`;
            }

        });
    }
    //выбор из ограниченного количества --> -
    function showQuantityMinus(eventMinusOn, changeMinusIn) {
        eventMinusOn.addEventListener('click', (e) => {

            changeMinusIn.textContent = `${--defNumberForRooms}`;
            if (defNumberForRooms < 1) {
                defNumberForRooms = 1;

                changeMinusIn.textContent = `${defNumberForRooms}`;
            }

        });
    }

    //

    const input = document.querySelectorAll('.reserve__rooms-input'), //псевдомассив вид номера
        calcPriceBtn = document.querySelector('.reserve__price-title'), //кнопка узнать цену
        endPriceBox = document.querySelector('.reserve__price-box'); //контейнер для вывода конечной стоимости


    calcPriceBtn.addEventListener('click', (e) => {
        let priceRoom;

        input.forEach(chek => {
            if (chek.checked == true) {
                priceRoom = chek.dataset.price;
            }
        });

        endPrice = +(nightNumber.textContent) * priceRoom * +(roomsNumber.textContent);

        endPriceBox.style = `
        background-color: #2C3E50;
        color: #fff;
        max-width: max-content;
        margin: 0 auto;
        margin-top: 50px;
        margin-bottom: 50px;
        text-align: center;
        font-size: 28px;
        font-weight: 700;
        padding: 30px;
        `;

        endPriceBox.textContent = `ИТОГО: ${endPrice} $
        `;

    });


    //плавность прокрутки к якорям
    const anchors = document.querySelectorAll('.header__item a[href*="#"]');

    for (let anchor of anchors) {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();

            const blockID = anchor.getAttribute('href').substr(1);

            document.getElementById(blockID).scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        });
    }
    //calendar pickmeup

    pickmeup('.range', {
        flat: true,
        mode: 'range',


    });
});